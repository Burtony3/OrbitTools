function varargout = M2E(e, M)%...Set an error tolerance:error = 1.e-12;%...Select a starting value for E:if M < pi    E = M + e/2;else    E = M - e/2;endE = M;%...Iterate on Equation 3.17 until E is determined to within%...the error tolerance:ratio = 1;iter = 0;Eiter = E;while abs(ratio) > error    iter = iter+1;    ratio = (E - e*sin(E) - M)/(1 - e*cos(E));    E = E - ratio;    Eiter(end+1) = E;endif nargout > 2    varargout = {E, iter, Eiter.'};elseif nargout > 1    varargout = {E, iter};else    varargout = {E};endend %kepler_E% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~