% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  function varargout = M2E(e, M)% ~~~~~~~~~~~~~~~~~~~~~~~~~~~%{  This function uses Newton's method to solve Kepler's   equation  E - e*sin(E) = M  for the eccentric anomaly,  given the eccentricity and the mean anomaly.  E  - eccentric anomaly (radians)  e  - eccentricity, passed from the calling program  M  - mean anomaly (radians), passed from the calling program  pi - 3.1415926...  User m-functions required: none%}% ----------------------------------------------%...Set an error tolerance:error = 1.e-8;%...Select a starting value for E:if M < pi    E = M + e/2;else    E = M - e/2;endE = M;%...Iterate on Equation 3.17 until E is determined to within%...the error tolerance:ratio = 1;iter = 0;Eiter = E;while abs(ratio) > error    iter = iter+1;    ratio = (E - e*sin(E) - M)/(1 - e*cos(E));    E = E - ratio;    Eiter(end+1) = E;endif nargout > 2    varargout = {E, iter, Eiter.'};elseif nargout > 1    varargout = {E, iter};else    varargout = {E};endend %kepler_E% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~